{% extends 'base.html.twig' %}
{% block title %}{{ sett('home_meta_title') }}{% endblock %}
{% block meta_description %}{{ sett('home_meta_description') }}{% endblock %}
{% block meta_keywords %}{{ sett('home_meta_keywords')}}{% endblock %}

{% block body_class %}home{% endblock %}
{% block before_content %}
{% set slider = load_nodes('slider').list %}
{% set cfg = [] %}
{% for slide in slider %}
{% set cfg = cfg|merge([{
    content: slide.vars.has('content') ? slide.vars.content : null,
    url: slide.vars.url,
    photo : slide.vars.photo ? {path : asset(slide.vars.photo.path), mime: slide.vars.photo.mime} : null,
    second : slide.vars.second_photo ? {path : asset(slide.vars.second_photo.path), mime: slide.vars.second_photo.mime} : null,
    mobile_photo : slide.vars.mobile_photo ? {path : asset(slide.vars.mobile_photo.path), mime: slide.vars.mobile_photo.mime} : null,
    mobile_second : slide.vars.mobile_second ? {path : asset(slide.vars.mobile_second.path), mime: slide.vars.mobile_second.mime} : null
}]) %}
{% endfor %}
{% if slider|length > 0 %}
{% set slide = slider[0] %}
<slider class="slider" :cfg="{{ cfg|json_encode }}">
    
    <div class="img">
        {% if 'video' in slide.vars.photo.mime %}
        <video width="100%" height="100%" autoplay loop>
          <source src="{{ asset(slide.vars.photo.path|default('video/top.mp4')) }}" type="{{ slide.vars.photo.mime }}" />
          {% if slide.vars.second_photo %}
          <source src="{{ asset(slide.vars.second_photo.path|default('video/top.webm')) }}" type="{{ slide.vars.second_photo.mime }}" />
          {% endif %}
        </video>
        {% else %}
            <div class="bg" style="background-image: url('{{ asset(slide.vars.photo.path) }}')"></div>
        {% endif %}
        <span></span>
    </div>
    <div class="wrap">
        <div class="content">
            <div class="text-content slider-content">
                {{ (slide.vars.has('content') ? slide.vars.content : null)|auto_blank|raw }}
            </div>
        </div>
    </div>
    <div class="btn-wrap" style="display:none">
        <a href="#content-start"><i class="icon-arrow-down4"></i></a>
    </div>
</slider>
{% endif %}
{% endblock %}
{% block content %}
    <div class="boxes-container">
    <div class="boxes ">
        {% for i in 1..4 %}
        <a class="box animate-block" data-aos-delay="{{ (i-1)*300 }}" data-aos-duration="1000" data-aos="fade-down" href="{{ sett('box_url_'~i) }}" style="">
            <span class="over"><span class="tit">{{ sett('box_title_'~i) }}</span>
            <span class="cnt"><span>{{ sett('box_text_'~i) }}</span></span></span>
        </a>
        {% endfor %}
    </div>
    </div>
<div id="content" style="background-color:rgba(255,255,255,0)">

    <div class="about animate-block" >
        <div class="wrap">
            <div class="cnt text-content intro-content" >
             
            <div data-aos="fade-left" data-aos-duration="1000" >
                {{ sett('intro_content')|auto_blank|raw }}
                </div>
            </div>
            <div class="left"></div>
        </div>
    </div>
    
    {% set news = load_node('page',{
            where: {
                public : true
            },
            module: {
                content : ['list', {
                    type: 'news'
                }]
            }
        }) %}
        {% set newsUrl = news.url|default('#') %}
    {% set items = load_nodes('news', {
        orderBy : { publishDate:'desc' },
        where: {
            public : true
        },
        max: 3,
        rand: true
    }).list %}
    <div class="reference">
        <h3 class="black-title"><a href="{{ newsUrl }}">Aktualności/Ogłoszenia</a></h3>
        <div class="wrap">
            <div class="list">
            {% for item in items %}
            <div class="item-wrap" >
                <div class="item  animate-block" data-aos-delay="{{ loop.index0*300 }}" data-aos-duration="1000"  data-aos="flip-left">
                    <h6 class="publishdate">{{ item.vars.publishDate | date("Y-m-d")}}</h6>
                    <h5>{{ item.vars.title }}</h5>
                    <p>{{ item.vars.lead|nl2br }}</p>
                    <a href="{{ item.url }}">więcej...</a>
                </div>
            </div>
            
            {% endfor %}
            </div>
        </div>
    </div>

</div>
{% endblock %}  