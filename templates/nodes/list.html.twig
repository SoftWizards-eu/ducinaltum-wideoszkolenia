{% if module.vars.type in ['news'] and (app.request.attributes.get('_route_params').id is defined and app.request.attributes.get('_route_params').id == '1' or app.request.pathInfo starts with '/node-1') %}
<div class="ducinaltum-search-bar-container">
    <div class="ducinaltum-search-bar-inner">
        <form action="{{ path(app.request.attributes.get('_route'), app.request.attributes.get('_route_params')) }}" method="GET" class="ducinaltum-search-bar-form">
            <input type="text" name="query" placeholder="Wyszukaj szkolenie..." value="{{ app.request.query.get('query') }}" class="ducinaltum-search-bar-input">
            <select name="category" class="ducinaltum-search-bar-select">
                <option value="">Wybierz kategorię szkolenia</option>
                <option value="1" {% if app.request.query.get('category') == '1' %}selected{% endif %}>Przebaczenie</option>
                <option value="2" {% if app.request.query.get('category') == '2' %}selected{% endif %}>Asertywność</option>
                <option value="3" {% if app.request.query.get('category') == '3' %}selected{% endif %}>Rozwój osobisty</option>
            </select>
            <button type="submit" class="ducinaltum-search-bar-button">SZUKAJ</button>
            <select name="sort" class="ducinaltum-search-bar-sort">
                <option value="">Sortuj szkolenia wg...</option>
                <option value="date" {% if app.request.query.get('sort') == 'date' %}selected{% endif %}>Data publikacji</option>
                <option value="title" {% if app.request.query.get('sort') == 'title' %}selected{% endif %}>Tytuł</option>
            </select>
        </form>
    </div>
</div>

<!-- Karty szkoleń -->
<div class="ducinaltum-training-container">
    <div class="ducinaltum-training-row">
        {% set news = load_nodes(module.vars.type, {
            orderBy : {publishDate:'desc'},
            max: module.vars.limit|default(6),
            pagging: true,
            where : {
                public : true
            },
            page : app.request.query.get('page', 1)
        }) %}
        {% for row in news.list|batch(3) %}
            {% for card in row %}
             <div class="ducinaltum-training-card">
                <div class="ducinaltum-training-card-inner">
                    <div class="ducinaltum-training-card-image">
                        <img src="{{ asset(card.vars.photo.path) }}" alt="{{ card.vars.title }}">
                    </div>
                    <div class="ducinaltum-training-card-content">
                        <h5 class="ducinaltum-training-card-title">{{ card.vars.title }}</h5>
                        <p class="ducinaltum-training-card-description">{{ card.vars.lead|nl2br }}</p>
                        <a href="{{ card.url }}" class="ducinaltum-training-card-link">Obejrzyj szkolenie <i class="fa-solid fa-play"></i></a>
                    </div>
                </div>
            </div>
            {% endfor %}
        {% endfor %}
    </div>
</div>

<!-- Brak wyników -->
{% if news.list|length == 0 %}
<div class="no-results">
    <p class="no-results-title">Nie znaleziono szkoleń spełniających kryteria wyszukiwania.</p>
    <p class="no-results-description">Spróbuj zmienić frazę wyszukiwania lub przeglądaj wszystkie dostępne szkolenia.</p>
</div>
{% endif %}

<!-- Paginacja -->
{% if news.pages|length > 1 %}
<div class="pagination-container">
    {% include 'nodes/pagging.html.twig' with news %}
</div>
{% endif %}

<!-- Przycisk "Zobacz wszystkie szkolenia" -->
{% if news.list|length >= module.vars.limit|default(9) %}
<div class="view-all-button">
    <a href="{{ path(app.request.attributes.get('_route'), app.request.attributes.get('_route_params')) }}">ZOBACZ WSZYSTKIE SZKOLENIA</a>
</div>
{% endif %}

{% elseif module.vars.type in ['news', 'blog', 'press', 'gallery'] %}
<section class="text text-content">
<div class="news-list">
{% set news = load_nodes(module.vars.type, {
    orderBy : {publishDate:'desc'},
    max: module.vars.limit|default(6),
    pagging: true,
    where : {
        public : true
    },
    page : app.request.query.get('page', 1)
}) %}
<div class="list">
    {% for item in news.list  %}
    <div class="news-item" data-aos="fade-right" data-aos-duration="1000"  data-aos-delay="{{ (loop.index0 % 3)*300 }}">
        <span class="photo" style="background-image: url('{{ (item.vars.photo ? item.vars.photo.path : cycle(['images/nophoto.jpg', 'images/nophoto2.jpg'], loop.index))|imagine_filter('blog') }}')"></span>
        <span class="nb"></span>
        <span class="over">
            <span class="tit">{{ item.vars.title }}</span>
            <span class="lead">
                {{ item.vars.lead|nl2br }}
            </span>
            <a href="{{ item.url }}" class="more">
                więcej
            </a>
        </span>
        <span class="nb last"></span>
    </div>
    {% endfor %}
</div>
{% include 'nodes/pagging.html.twig' with news %}
</div>
</section>
{% elseif module.vars.type in ['reference'] %}
<section class="text text-content">
<div class="news-list">
{% set news = load_nodes(module.vars.type, {
    orderBy : {publishDate:'desc'},
    max: module.vars.limit|default(6),
    pagging: true,
    where : {
        public : true
    },
    page : app.request.query.get('page', 1)
}) %}
<div class="reference reference-simple">
    {% for row in news.list|batch(3) %}
    <div class="wrap">
        <div class="list">
        {% for item in row %}
        <div class="item-wrap" >
            <div class="item ">
                <h5>{{ item.vars.title }}</h5>
                <p>{{ item.vars.lead|nl2br }}</p>
                <a href="{{ item.url }}">więcej...</a>
            </div>
        </div>
        {% endfor %}
        </div>
    </div>
    {% endfor %}
</div>
{% include 'nodes/pagging.html.twig' with news %}
</div>
</section>
{% endif %}